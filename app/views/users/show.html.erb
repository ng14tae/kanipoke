<div class="max-w-4xl mx-auto px-6 py-8">
    <div class="bg-transparent border-2 border-white rounded-lg shadow-md p-6 mb-6">
        <div class="flex justify-center items-center mb-4">
        <h1 style="font-size: clamp(1.5rem, 4vw, 1.75rem); font-weight: bold; margin-bottom: 1.5rem;">
            <%= @user.name %>のマイページ</h1>
        </div>
        <div class="flex justify-center items-center mb-4">
        <%= link_to "名前変更", edit_user_path(@user),
            class: "bg-blue-500 hover:bg-blue-700 text-gray font-bold py-2 px-4 rounded" %>

        <%= link_to "削除", user_path(@user),
        method: :delete,
        data: {
        turbo_confirm: "#{@user.first_name} #{@user.last_name}を削除します。本当に削除しますか？",
        turbo_method: :delete
    },
    class: "px-4 py-2 bg-transparent text-white rounded hover:bg-red-600 transition-colors duration-200 text-center inline-block" %>
        </div>
    </div>
</div>

<div class="max-w-4xl mx-auto px-6 py-4">
    <div class="bg-transparent border-2 border-white rounded-lg shadow-md p-6">
        <h2 class="text-lg font-bold mb-3">戦歴（合計: <%= @battles.count %>）</h2>

        <% if @most_opponent %>
            <div class="mb-3">
                <strong>最も多く戦った相手:</strong>
                <%= link_to @most_opponent.name, user_path(@most_opponent), class: "underline" %>
                （<%= @record_vs_most[:total] %>戦）
            </div>
            <div class="mb-4">
                <strong>対戦成績:</strong>
                勝ち <%= @record_vs_most[:wins] %> ／ 負け <%= @record_vs_most[:losses] %> ／ 引き分け <%= @record_vs_most[:draws] %>
            </div>
        <% else %>
            <div class="mb-4">まだ対戦履歴がありません。</div>
        <% end %>

        <ul class="space-y-2">
            <% @battles.each do |b| %>
                <% other = (b.user_id == @user.id) ? b.opponent : b.user %>
                <% result = if b.winner_id.nil? then '引き分け' elsif b.winner_id == @user.id then '勝ち' else '負け' end %>
                <li class="flex justify-between items-center">
                    <div>
                        <%= l(b.created_at, format: :short) %> — <%= link_to other.name, user_path(other) %>
                    </div>
                    <div class="text-sm text-gray-200"><%= result %></div>
                </li>
            <% end %>
        </ul>
    </div>
</div>