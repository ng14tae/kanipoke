<div class="container mx-auto px-4 py-8">
<div class="bg-white bg-opacity-10 rounded-lg shadow-lg p-6">
    <h1 class="text-4xl font-bold mb-8 text-center">
    🏆 週間ランキング
    </h1>

    <!-- 期間表示セクション（シンプル版） -->
    <div class="text-center mb-8">
        <div class="bg-white bg-opacity-20 rounded-lg p-4 mb-4">
            <p class="text-lg text-yellow-200 font-semibold mb-2">
                📅 集計期間
            </p>
            <p class="text-xl text-white font-medium">
                <%= @start_date.strftime('%Y年%m月%d日(%a)') %> ～ <%= @end_date.strftime('%Y年%m月%d日(%a)') %>
            </p>
            <p class="text-sm text-gray-300 mt-2">
                <%= @period_description %>の対戦成績を集計
            </p>
        </div>

        <% if false %>
            <!-- 週の進行状況 -->
            <div class="mt-3">
                <% days_passed = (Date.current - @start_date.to_date).to_i + 1 %>
                <% days_passed = [days_passed, 7].min %>
                <div class="bg-gray-600 rounded-full h-2 mb-2">
                    <div class="bg-yellow-400 h-2 rounded-full transition-all duration-500"
                        style="width: <%= (days_passed / 7.0 * 100) %>%"></div>
                </div>
                <p class="text-xs text-gray-400">
                    今週 <%= days_passed %>/7日経過
                </p>
            </div>
        <% end %>

            <!-- リアルタイム更新時刻 -->
            <p class="text-xs text-gray-400 mt-2">
                最終更新: <%= @update_time.strftime('%Y年%m月%d日 %H:%M') %>
            </p>
        </div>
    </div>

    <div class="text-center mb-8">
            <p class="text-lg md:text-xl lg:text-3xl font-semibold mb-2">
                今週の🦀王は誰だ……！？
            </p>
    </div>

    <!-- ランキング切り替えボタン -->
    <div class="flex justify-center mb-8 space-x-4">
    <%= link_to "総合ランキング", ranking_users_path,
        class: "px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors duration-200" %>
    <%= link_to "週間ランキング", weekly_ranking_users_path,
        class: "px-6 py-2 bg-yellow-500 text-black rounded-lg font-semibold shadow-lg" %>
    </div>

    <% if @users.any? %>
    <div class="space-y-4">
        <% @users.first(10).each_with_index do |user, index| %>
        <div class="flex items-center justify-between bg-white bg-opacity-20 rounded-lg p-4 hover:bg-opacity-30 transition-all duration-200">
            <!-- ランキング順位 -->
            <div class="flex items-center space-x-4">
            <div class="text-3xl font-bold min-w-[60px]">
                <% case index %>
                <% when 0 %>
                １位
                <% when 1 %>
                2位
                <% when 2 %>
                3位
                <% else %>
                <span class="text-2xl"><%= index + 1 %>位</span>
                <% end %>
            </div>

            <!-- ユーザー名 -->
            <div>
                <%= link_to user_path(user),
                    class: "text-2xl font-semibold hover:text-yellow-300 transition-colors duration-200" do %>
                <%= user.display_name %>
                <% end %>
            </div>
            </div>

            <!-- 戦績情報（週間限定データ） -->
            <div class="flex items-center space-x-6 text-lg">
            <!-- 勝率 -->
            <div class="text-center">
                <div class="text-2xl font-bold">
                <%= user.weekly_win_rate.round(1) %>%
                </div>
                <div class="text-sm text-gray-300">勝率</div>
            </div>

            <!-- 勝利数 -->
            <div class="text-center">
                <div class="text-xl font-semibold">
                <%= user.weekly_wins %>勝
                </div>
                <div class="text-sm text-gray-300">勝利</div>
            </div>

            <!-- 敗北数 -->
            <div class="text-center">
                <div class="text-xl font-semibold">
                <%= user.weekly_losses %>敗
                </div>
                <div class="text-sm text-gray-300">敗北</div>
            </div>

            <!-- 総試合数 -->
            <div class="text-center">
                <div class="text-xl font-semibold">
                <%= user.weekly_total_games %>試合
                </div>
                <div class="text-sm text-gray-300">総試合</div>
            </div>


            </div>
        </div>
        <% end %>
    </div>
    <% else %>
    <div class="text-center py-12">
        <div class="text-6xl mb-4">📅</div>
        <h2 class="text-2xl font-semibold mb-2">今週の対戦データがありません</h2>
        <p class="text-gray-300 mb-6">今週の対戦を開始してランキングを作成しましょう！</p>
        <%= link_to "対戦を開始", new_battle_path,
            class: "px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors duration-200 font-semibold" %>
    </div>
    <% end %>

    <!-- 戻るボタン -->
    <div class="text-center mt-8">
    <%= link_to "← ホームに戻る", root_path,
        class: "px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors duration-200" %>
    </div>
</div>
</div>